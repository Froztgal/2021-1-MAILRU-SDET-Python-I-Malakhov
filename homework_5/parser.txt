#!/bin/bash
echo '1 -- Общее количество запросов' > bash_result.txt; wc -l < access.log >> bash_result.txt; echo '2 -- Общее количество запросов по типу, например: GET - 20, POST - 10 и т.д.' >> bash_result.txt; cat access.log | awk -F\" '{print $2}' | awk '{print $1}' | sort -n | uniq -c | sort -nr >> bash_result.txt; echo '3 -- Топ 10 самых частых запросов' >> bash_result.txt; cat  access.log | awk '{print $7}' | sort | uniq -c | sort -rn | head -10 >> bash_result.txt; echo '4 -- Топ 5 самых больших по размеру запросов, которые завершились клиентской (4ХХ) ошибкой' >> bash_result.txt; awk '($9 >= 400) && ($9 < 500)' access.log | awk '{print $7,$9,$10,$1}' | sort | uniq -c | sort -rn | head -5 >> bash_result.txt; echo '5 -- Топ 5 пользователей по количеству запросов, которые завершились серверной (5ХХ) ошибкой' >> bash_result.txt; awk '($9 >= 500)' access.log | awk '{print $1}' | sort | uniq -c | sort -rn | head -5 >> bash_result.txt;
